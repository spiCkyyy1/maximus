var min = document.querySelector('#min');
var max = document.querySelector('#max');
var span = document.querySelector('#val');
var slide = document.querySelector('#slide');
var button = document.querySelector('#limitButton');

displayValue.call(slide, {});

function displayValue (e) {
  var inp = e.target || this;
  var value = +inp.value;
  var min = inp.min;
  var max = inp.max;
  var width = inp.offsetWidth;
  var offset = -20;
  var percent = (value - min) / (max - min);
  var pos = percent * (width + offset) - 40;
  span.style.left = "${pos}px";
  span.innerHTML = value;
}

function changeLimits () {
  var minVal = +min.value;
  var maxVal = +max.value;
  var value = (maxVal - minVal) * (Math.random()*(0.8-0.2) + 0.2) + minVal;
  slide.setAttribute('min', minVal);
  slide.setAttribute('max', maxVal);
  slide.setAttribute('value', value);
  displayValue.call(slide, {});
}

function checkPostiveInteger (e) {
  var c = e.keyCode;
  if ((c < 37 && c != 8 && c != 9) || (c > 40 && c < 48 && c != 46) || (c > 57 && c < 96) || (c > 105 && c != 109 && c != 189)) {
    e.preventDefault();
  }
  if (c === 13 && checkValidLimits()) {
    changeLimits();
  }
}

function checkValidLimits () {
  return (!min.value || !max.value || +max.value <= +min.value) ? (button.disabled = true, false) : (button.disabled = false, true);
}